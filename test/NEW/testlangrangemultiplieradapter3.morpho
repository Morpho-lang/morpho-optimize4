// Test the lagrange multiplier adapter

import optimize4 

import "lagrangemultiplieradapter2.morpho"


//import "../examples/constrainedloop.morpho" for ConstrainedLoop
//var example = ConstrainedLoop(Np=10, L=0.5)

import "../examples/loop.morpho" for Loop
var example = Loop(Np=10)

var adapter = example.build()

//example.visualize()

import "sqpcontroller2.morpho"

print adapter.constraintValue()

var control = SQPController(adapter)
control.etol = 1e-16

control.optimize(500) 
//print adapter.get() 
print "lambda:"
print control.ladapter.lagrangeMultipliers()

print control.ladapter.value() 

//var K = control.kkt()
//print K.eigenvalues() 

//example.visualize()